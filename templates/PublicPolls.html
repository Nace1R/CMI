<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CMI City - Public Polls</title>
  <script src="https://unpkg.com/vue@3"></script>
  <script src="https://unpkg.com/naive-ui"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/naive-ui/dist/naive-ui.css">
  <link rel="stylesheet" href="https://maxst.icons8.com/vue-static/landings/line-awesome/line-awesome/1.3.0/css/line-awesome.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="icon" type="image/png" href="{{ url_for('static', filename='slike/favicon5.png') }}">
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f5f5f5;
    }
    .navbar {
      height: 64px;
      background-color: white;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 20px;
      z-index: 10;
    }
    .navbar-left, .navbar-right {
      display: flex;
      align-items: center;
    }
    .logo {
      height: 40px;
      margin-right: 20px;
    }
    .username {
      font-weight: 500;
      color: #333;
      cursor: pointer;
    }
    .main-container {
      display: flex;
      min-height: 100vh;
    }
    .sidebar {
      background-color: #1B365C;
      color: white;
      transition: width 0.3s ease;
      overflow-y: auto;
      box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
    }
    .sidebar-expanded {
      width: 240px;
    }
    .sidebar-collapsed {
      width: 64px;
    }
    .polls-wrapper {
      flex: 1;
      padding: 40px;
    }
    .polls-header {
      text-align: center;
      margin-bottom: 40px;
    }
    .poll-card {
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.05);
      margin-bottom: 24px;
      padding: 24px;
      transition: all 0.3s ease;
    }
    .poll-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
    }
    .poll-title {
      font-size: 1.5rem;
      font-weight: bold;
      margin-bottom: 12px;
    }
    .poll-description {
      font-size: 1rem;
      margin-bottom: 16px;
    }
    .poll-meta {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      color: #666;
      font-size: 0.95rem;
    }
    .poll-meta i {
      margin-right: 6px;
      color: #888;
    }
  </style>
</head>
<body>
  <div id="app">
    <div class="navbar">
      <div class="navbar-left">
        <n-button quaternary circle @click="toggleSidebar">
          <template #icon>
            <n-icon>
              <i :class="collapsed ? 'las la-angle-right' : 'las la-bars'"></i>
            </n-icon>
          </template>
        </n-button>
        <img src="{{ url_for('static', filename='slike/logo2.png') }}" alt="CMI Logo" class="logo">
      </div>
      <div class="navbar-right">
        <n-dropdown :options="UserOptions" @select="handleSelect">
          <n-button><span class="username">{{userData.ime}}</span></n-button>
        </n-dropdown>
        <n-avatar round size="medium" src="{{pfp}}"></n-avatar>
      </div>
    </div>

    <div class="main-container">
      <div class="sidebar" :class="collapsed ? 'sidebar-collapsed' : 'sidebar-expanded'">
        <n-menu
          v-model:value="activeKey"
          :collapsed="collapsed"
          :collapsed-width="64"
          :collapsed-icon-size="22"
          :options="menuOptions"
          :indent="18"
          inverted
        />
      </div>
      <div class="polls-wrapper">
        <div class="polls-header">
          <h1>Public Polls</h1>
          <p>View all ongoing public polls where you can participate and earn perks for nice rewards!</p>
        </div>
        {% for poll in showPollData.polls %}
        <div class="poll-card">
          <div class="poll-title">{{ poll.naslov }}</div>
          <div class="poll-description">{{ poll.opis }}</div>
          <div class="poll-meta">
            <div><i class="las la-map-marker-alt"></i>{{ poll.mesto }}</div>
            <div><i class="las la-clock"></i>{{ poll.timeLeft[0] }}d {{ poll.timeLeft[1] }}h left</div>
            <div><i class="las la-gift"></i>Reward: {{ poll.reward }} pts</div>
            <div><i class="las la-id-badge"></i>ID: {{ poll.pollId }}</div>
          </div>
        </div>
        {% else %}
        <p>No active polls available.</p>
        {% endfor %}
      </div>
    </div>
  </div>

  <script>
    const { createApp, ref, h } = Vue;
    createApp({
      setup() {
        const collapsed = ref(false);
        const activeKey = ref('polls');
        const userData = ref({ ime: 'John Doe' });

        const UserOptions = ref([
          { label: 'Manage Profile', key: 'manageProfile' },
          { label: 'Admin Dashboard', key: 'adminPanel' },
          { label: 'Logout', key: 'logout' }
        ]);
        function renderIcon(iconClass) {
            return () => h('i', { class: iconClass });
        }

        const menuOptions = [
                        {
                            label: 'Dashboard', // The text shown in the menu
                            key: 'dashboard',    // Unique identifier for this item
                            icon: renderIcon('las la-tachometer-alt'), // Dashboard icon
                            onClick: () => {
                                window.location.href = '/dashboard';
                            }

                        },

                        {
                            label: 'City Guides',
                            key: 'guides',
                            icon: renderIcon('las la-map-marked-alt'),
                            disabled:true, 
                            onClick: () => {
                                window.location.href = '/cityGuides';
                            }
                            // Submenu items (children)
 /*                           children: [
                                {
                                    label: 'Testing submenus',
                                    key: 'ustavi-key-tu'
                                },
                                {
                                    label: 'Testing submenus',
                                    key: 'ustavi-key-tu'
                                },
                                {
                                    label: 'Testing submenus',
                                    key: 'ustavi-key-tu'
                                }
                            ] TRENUTNO NE POTREBUJEM TU SUBMENUJEV ODKOMENTIRAJ PO POTREBI!!!!!!!!!!!!!*/
                        },

                        {
                            label: 'Public Polls',
                            key: 'polls',
                            icon: renderIcon('las la-poll'),
                            onClick: () => {
                                window.location.href = '/publicPolls';
                            } 
                            /*children: [
                                {
                                    label: 'Testing submenus',
                                    key: 'ustavi-key-tu'
                                },
                                {
                                    label: 'Testing submenus',
                                    key: 'ustavi-key-tu'
                                },
                                {
                                    label: 'Testing submenus',
                                    key: 'ustavi-key-tu'
                                }
                            ]*/
                        },

                        {
                            label: 'Weather Updates',
                            key: 'wUpdates',
                            icon: renderIcon('las la-cloud-sun'),
                            onClick: () => {
                                window.location.href = '/weatherData';
                            } 
                            /*children: [
                                {
                                    label: 'Testing submenus',
                                    key: 'ustavi-key-tu'
                                },
                                {
                                    label: 'Testing submenus',
                                    key: 'ustavi-key-tu'
                                }
                            ]*/
                        },

                        {
                            label: 'Traffic Updates',
                            key: 'tUpdates',
                            icon: renderIcon('las la-traffic-light'),
                            disabled:true,
                            onClick: () => {
                                window.location.href = '/trafficData';
                            }  
                            /*children: [
                                {
                                    label: 'Testing submenus',
                                    key: 'ustavi-key-tu'
                                },
                                {
                                    label: 'Testing submenus',
                                    key: 'ustavi-key-tu'
                                }
                            ]*/
                        },
                  //      {
                  //          label: 'Social',
                  //          key: 'social',
                   //         icon: renderIcon('las la-users'), 
                            /*children: [
                                {
                                    label: 'Testing submenus',
                                    key: 'ustavi-key-tu'
                                },
                                {
                                    label: 'Testing submenus',
                                    key: 'ustavi-key-tu'
                                }
                            ]*/
                   //     },
                        {
                            label: 'Local Events',
                            key: 'lEvents',
                            icon: renderIcon('las la-calendar-alt'),
                            disabled:true,
                            onClick: () => {
                                window.location.href = '/localEvents';
                            }  
                            /*children: [
                                {
                                    label: 'Testing submenus',
                                    key: 'ustavi-key-tu'
                                },
                                {
                                    label: 'Testing submenus',
                                    key: 'ustavi-key-tu'
                                }
                            ]*/
                        },
                        {
                            label: 'Electrical Information',
                            key: 'eInfo',
                            icon: renderIcon('las la-bolt'),
                            disabled:true,
                            onClick: () => {
                                window.location.href = '/electricalInfo';
                            } 
                            /*children: [
                                {
                                    label: 'Testing submenus',
                                    key: 'ustavi-key-tu'
                                },
                                {
                                    label: 'Testing submenus',
                                    key: 'ustavi-key-tu'
                                }
                            ]*/
                        },
                        {
                            label: 'Public Transit Info',
                            key: 'ptInfo',
                            icon: renderIcon('las la-bus'),
                            disabled:true,
                            onClick: () => {
                                window.location.href = '/publicTransit';
                            }  
                            /*children: [
                                {
                                    label: 'Testing submenus',
                                    key: 'ustavi-key-tu'
                                },
                                {
                                    label: 'Testing submenus',
                                    key: 'ustavi-key-tu'
                                }
                            ]*/
                        },
                        {
                            label: 'Perks and Rewards',
                            key: 'PaR',
                            icon: renderIcon('las la-gift'),
                            disabled:false,
                            onClick: () => {
                                window.location.href = '/perksRewards';
                            }  
                            /*children: [
                                {
                                    label: 'Testing submenus',
                                    key: 'ustavi-key-tu'
                                },
                                {
                                    label: 'Testing submenus',
                                    key: 'ustavi-key-tu'
                                }
                            ]*/
                        },


                        // About Us menu item
                        
                        {
                            label: 'About Us',
                            key: 'aboutus',
                            icon: renderIcon('las la-info-circle'), // About/information icon
                            onClick: () => {
                                window.location.href = '/about_us';
                            }
                        }
                    ];
        const toggleSidebar = () => {
          collapsed.value = !collapsed.value;
        };

        const handleSelect = (key) => {
          if (key === 'logout') window.location.href = '/logout';
          else if (key === 'manageProfile') window.location.href = '/manageProfile';
          else if (key === 'adminPanel') window.location.href = '/adminDashboard';
        };

        return {
          collapsed,
          activeKey,
          userData,
          UserOptions,
          menuOptions,
          toggleSidebar,
          handleSelect
        };
      }
    }).use(naive).mount('#app');
  </script>
</body>
</html>
